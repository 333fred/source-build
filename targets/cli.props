<?xml version="1.0" encoding="utf-8"?>
<Project ToolsVersion="15.0" xmlns="http://schemas.microsoft.com/developer/msbuild/2003">

  <PropertyGroup>
    <CLITargetsArgument Condition="'$(OS)' == 'Windows_NT'">'/p:CLITargets=\&quot;\&quot;\&quot;Prepare;Compile;Package\&quot;\&quot;\&quot;'</CLITargetsArgument>
    <CLITargetsArgument Condition="'$(OS)' != 'Windows_NT'">'/p:CLITargets=&quot;Prepare;Compile;Package&quot;'</CLITargetsArgument>
    <ProjectDirectory Condition="'$(PathToRepo)' != ''">$(PathToRepo)</ProjectDirectory>
    <OverridesForCommands>$(PackagesOverride) $(DotnetToolsetInstallOverride) $(BuildToolsetInstallOverride) DOTNET_SKIP_FIRST_TIME_EXPERIENCE=1</OverridesForCommands>

    <SyncCommand Condition="'$(TargetOS)' != 'Windows_NT'" >DOTNET_INSTALL_DIR=.dotnet_stage0/x64 scripts/obtain/dotnet-install.sh -Channel master -Architecture x64; $(OverridesForCommands) $(PreBuiltDotnetCliDir)/dotnet msbuild $(ProjectDirectory)/build.proj /p:GeneratePropsFile=true /t:WriteDynamicPropsToStaticPropsFiles /t:RestoreDotnetCliBuildFramework</SyncCommand>
    <BuildCommand>$(OverridesForCommands) SOURCE_BUILT_NUGET_PACKAGES=$(SourceBuiltPackagesPath) $(ProjectDirectory)build$(ShellExtension) $(CLITargetsArgument) /v:detailed /p:SkipBuildingInstallers=true /p:IncludeNuGetPackageArchive=false /p:IncludeAdditionalSharedFrameworks=false /flp:v=detailed /p:CoreSetupBlobRootUrl=file:%2F%2F$(LocalBlobStorageRoot) /p:UsePortableLinuxSharedFramework=false</BuildCommand>
    <PackagesOutput>$(ProjectDirectory)artifacts/$(TargetRid)/packages/</PackagesOutput>
    <UpdateCommand>$(OverridesForCommands) (set DOTNET_VERSION_URL=file:%2F%2F$(LocalBuildInfoRoot)) &amp; powershell.exe $(ProjectDirectory)build_projects/update-dependencies/update-dependencies.ps1 -Update</UpdateCommand>
    <UpdateCommand Condition="'$(OS)' != 'Windows_NT'">$(OverridesForCommands) SOURCE_BUILT_NUGET_PACKAGES=$(SourceBuiltPackagesPath) DOTNET_VERSION_URL=file:%2F%2F$(LocalBuildInfoRoot) $(ProjectDirectory)build_projects/update-dependencies/update-dependencies$(ShellExtension) --Update</UpdateCommand>
  </PropertyGroup>

  <ItemGroup>
    <RepositoryReference Include="application-insights" />
    <RepositoryReference Include="core-setup" />
    <RepositoryReference Include="msbuild" />
    <RepositoryReference Include="netcorecli-fsc" />
    <RepositoryReference Include="newtonsoft-json" />
    <RepositoryReference Include="nuget-client" />
    <RepositoryReference Include="roslyn" />
    <RepositoryReference Include="sdk" />
    <RepositoryReference Include="templating" />
    <RepositoryReference Include="vstest" />
    <RepositoryReference Include="websdk" />
  </ItemGroup>
</Project>
