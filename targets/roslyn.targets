<?xml version="1.0" encoding="utf-8"?>
<Project ToolsVersion="15.0" DefaultTargets="Build" xmlns="http://schemas.microsoft.com/developer/msbuild/2003">
  <UsingTask AssemblyFile="$(TasksBinDir)Microsoft.DotNet.SourceBuild.Tasks.dll" TaskName="ChangeRuntimesSection" />
  <UsingTask AssemblyFile="$(TasksBinDir)Microsoft.DotNet.SourceBuild.Tasks.dll" TaskName="FixPathSeparator" />

  <Target Name="UpdateRuntimeSection" BeforeTargets="Build">
    <ItemGroup>
      <RoslynProjectJsonFiles Include="$(ProjectDirectory)/**/project.json" />
      <NuSpecFiles Include="$(ProjectDirectory)/**/*.nuspec" />
    </ItemGroup>
    <ChangeRuntimesSection ProjectJsonFiles="@(RoslynProjectJsonFiles)"
                           ReplacementRuntimeId="$(TargetRid)"
                           FilterRuntimeId="ubuntu.14.04-x64"
                           Condition="'$(TargetOS)' == 'Linux'" />

    <FixPathSeparator NuSpecFiles="@(NuSpecFiles)" />
  </Target>
</Project>
